# TraaSh Traffic Simulator

An Java application that simulates traffic using SUMO (Simulation of Urban Mobility) through the TraaS library.

## Table of Contents
1. [Project Structure](#project-structure)
2. [Dependencies](#dependencies)
3. [Resource Files](#resource-files)
4. [Compilation and Running](#compilation-and-running)
5. [Source Code Overview](#source-code-overview)
6. [Current Results](#current-results)
7. [Next Steps: Custom JavaFX Visualization](#next-steps-custom-javafx-visualization)
8. [Development Roadmap](#development-roadmap)


## Project Structure
```
Traffic_light/
├── lib/
│   └── TraaS.jar          # TraaS library for SUMO integration
├── resource/
│   ├── network.net.xml    # Road network definition
│   ├── cars.rou.xml       # Car vehicle routes
│   ├── trucks.rou.xml     # Truck vehicle routes
│   ├── motorcycles.rou.xml # Motorcycle routes
│   ├── buses.rou.xml      # Bus routes
│   ├── emergency.rou.xml  # Emergency vehicle routes
│   └── simulation.sumocfg # Main SUMO configuration
├── src/
│   ├── TestTraaS.java     # Main simulation controller
│   └── TraaSTools.java    # SUMO utility methods
└── createMap.sh           # Script to generate simulation files
```
## Dependencies

### lib/TraaS.jar
- *Purpose*: Java library that provides TraCI (Traffic Control Interface) bindings for SUMO
- *Functionality*: Enables Java programs to control and monitor SUMO simulations in real-time
- *Key Classes*: SumoTraciConnection, Simulation, Vehicle, etc.

## Resource Files (Please Reference /docs/Insight.md)

### network.net.xml
- *What it is*: An XML file containing the complete road network topology for the simulation
- *What it does*: Defines all junctions (intersections), edges (roads), lanes, connections, and traffic rules that vehicles navigate
- *How it was created*: Generated automatically by SUMO's netgenerate tool using random grid parameters to create a synthetic urban road network
- *Key elements*: Node positions, edge geometries, lane counts, speed limits, and junction logic

### *.rou.xml Files (Routes)
- *What they are*: XML files that define vehicle types, their visual appearance, behavior parameters, and the routes they follow through the network

#### Example: cars.rou.xml
- *What it does*: Spawns passenger cars with realistic acceleration, deceleration, and speed characteristics
- *Properties*: Red color, spawning period of 200 seconds (1 car every 200s)
- *How it was created*: Generated using SUMO's randomTrips.py script with car-specific parameters

### simulation.sumocfg
- *What it is*: The master configuration file that ties all simulation components together
- *What it does*: 
    - References all network and route files to load them into the simulation
    - Sets the simulation time window (start and end times)
    - Configures processing options like step length (0.1s default)
    - Defines output settings and GUI parameters
- *How it was created*: Manually written or generated by the createMap.sh script to coordinate all XML resources into a single executable simulation scenario

## Compilation and Running

### Prerequisites
- Java 17
- SUMO installed and $SUMO_HOME environment variable set
- Linux/Mac environment (commands use : classpath separator)

### Compile
cd /path/to/TraaShTrafficSimulator
javac -cp "lib/TraaS.jar" src/*.java

### Run
java -cp "lib/TraaS.jar:src" TestTraaS

### Notes
- Classpath includes both the TraaS library and compiled classes
- SUMO GUI will open automatically showing the simulation
- Program runs for 1000 simulation steps (approximately 100 seconds)

## Source Code Overview

### TestTraaS.java (Main Class)
- *Purpose*: Controls the simulation flow and user interface
- *Functionality*:
    - Establishes TraCI connection to SUMO
    - Runs simulation in a loop (1000 steps)
    - Prints simulation time and vehicle counts
    - Displays position of each vehicle in real-time
    - Handles connection cleanup

### TraaSTools.java (Utility Class)
- *Purpose*: Provides static methods for SUMO operations
- *Key Methods*:
    - getAllVehicleIds(): Retrieves list of active vehicles
    - getVehiclePosition(): Gets vehicle coordinates (x, y in meters)
    - getVehicleSpeed(): Gets vehicle velocity
    - Other vehicle, network, and traffic light utilities

### Program Flow
1. Connect to SUMO via TraCI
2. Start simulation server
3. For each simulation step:
     - Advance time by 1 step (0.1 seconds)
     - Query current vehicles
     - Print statistics and positions
     - Pause briefly for visualization
4. Close connection when finished

## Current Results

The program currently outputs real-time simulation data to the console:

Step 835 - Time: 836.0 - Vehicles: 3
Vehicle ID: ambulance1 
Positions: x=73.19892705924067 y=106.56816667451905
Vehicle ID: car4 
Positions: x=112.02747565848885 y=159.02586491296475
Vehicle ID: moto8 
Positions: x=72.78899838840829 y=265.39990456767305
Step 836 - Time: 837.0 - Vehicles: 3
Vehicle ID: ambulance1 
Positions: x=73.19892705924067 y=106.56816667451905
Vehicle ID: car4 
Positions: x=112.02747565848885 y=159.02586491296475
Vehicle ID: moto8 
Positions: x=76.44819366062863 y=280.6364635282416

### Output Explanation
- *Simulation time progression*: Each step represents 1 second of simulation time
- *Active vehicles*: Number of vehicles currently in the simulation
- *Vehicle IDs*: Unique identifiers (e.g., ambulance1, car4, moto8)
- *Real-time positions*: X,Y coordinates in meters within the network space


## Next Steps: Custom JavaFX Visualization

### Planned Features
The next phase is to build a custom 2D visualization using JavaFX to replace the default SUMO GUI:

1. *Network Rendering*
   - Parse network.net.xml to extract road geometry
   - Draw junctions (intersections) as nodes
   - Draw edges (roads) as lines with lane markings
   - Implement coordinate transformation (SUMO meters → screen pixels)

2. *Real-time Vehicle Plotting*
   - Plot vehicle positions as colored shapes based on type:
     - Cars: Red circles
     - Trucks: Blue rectangles
     - Motorcycles: Black small circles
     - Buses: Green rectangles
     - Emergency: Yellow triangles
   - Update positions every simulation step
   - Add vehicle ID labels on hover

3. *Interactive Control s*
   - Zoom and pan functionality
   - Play/pause simulation
   - Speed control (slow motion, fast forward)
   - Click vehicles for detailed information


### Technical Implementation Plan
- *JavaFX Canvas*: For efficient 2D rendering of roads and vehicles
- *XML Parser*: Parse network.net.xml for road coordinates
- *AnimationTimer*: Synchronize GUI updates with SUMO simulation steps
- *Coordinate mapping*: Transform SUMO's metric coordinates to screen pixels with proper scaling

---

## Development Roadmap
- [x] Basic SUMO connection via TraaS
- [x] Vehicle tracking and position retrieval
- [x] Console output of simulation data
- [ ] Parse network.net.xml for road topology
- [ ] JavaFX window with canvas
- [ ] Render road network
- [ ] Plot vehicles in real-time
- [ ] Add interactive controls
- [ ] Implement visualization features

## References
- [SUMO Documentation - Eclipse SUMO](https://sumo.dlr.de/docs/index.html)
- [Abstract Network Generation - SUMO Documentation](https://sumo.dlr.de/docs/Networks/Abstract_Network_Generation.html)
- [TraaS Java Documentation - Index](https://sumo.dlr.de/javadoc/traas/)
- [TraaS Java Documentation - Package de.tudresden.sumo.objects](https://sumo.dlr.de/javadoc/traas/de/tudresden/sumo/objects/package-summary.html)
- [TraaS Java Documentation - Package de.tudresden.sumo.cmd](https://sumo.dlr.de/javadoc/traas/de/tudresden/sumo/cmd/package-summary.html)
